{
	"name": "Analyze Internet Sales",
	"properties": {
		"content": {
			"query": "/*\nselect d.CalendarYear as Year,\n       pc.EnglishProductCategoryName as ProductCategory,\n       g.EnglishCountryRegionName as Region,\n    sum(i.SalesAmount) as InternetSalesAmount\nfrom FactInternetSales i\njoin DimDate d on i.OrderDateKey = d.DateKey\njoin DimCustomer c on i.CustomerKey = c.CustomerKey\njoin DimGeography g on c.GeographyKey = g.GeographyKey\njoin DimProduct p on i.ProductKey = p.ProductKey\njoin DimProductSubcategory ps on p.ProductSubcategoryKey = ps.ProductSubcategoryKey\njoin DimProductCategory pc on ps.ProductCategoryKey = pc.ProductCategoryKey\ngroup by d.CalendarYear, pc.EnglishProductCategoryName, g.EnglishCountryRegionName\norder by Year, ProductCategory, Region;\n*/\n\n/*\nselect g.EnglishCountryRegionName as Region,\n    ROW_NUMBER() over(PARTITION by g.EnglishCountryRegionName\n                        order by i.SalesAmount asc) as RowNumber,\n    i.SalesOrderNumber as OrderNo,\n    i.SalesOrderLineNumber as LineItem,\n    i.SalesAmount as SalesAmount,\n    sum(i.SalesAmount) over(PARTITION by g.EnglishCountryRegionName) as RegionTotal,\n    avg(i.SalesAmount) over(PARTITION by g.EnglishCountryRegionName) as RegionAverage\nfrom FactInternetSales i\njoin DimDate d on i.OrderDateKey = d.DateKey\njoin DimCustomer c on i.CustomerKey = c.CustomerKey\njoin DimGeography g on c.GeographyKey = g.GeographyKey\nwhere d.CalendarYear = 2022\norder by Region;\n*/\n\nselect g.EnglishCountryRegionName as Region,\n       g.City,\n       sum(i.SalesAmount) as CityTotal,\n       sum(sum(i.SalesAmount)) over(PARTITION by g.EnglishCountryRegionName) as RegionTotal,\n       rank() over(PARTITION by g.EnglishCountryRegionName\n            order by sum(i.SalesAmount) desc) as RegionalRank\nfrom FactInternetSales i\njoin DimDate d on i.OrderDateKey = d.DateKey\njoin DimCustomer c on i.CustomerKey = c.CustomerKey\njoin DimGeography g on c.GeographyKey = g.GeographyKey\ngroup by g.EnglishCountryRegionName, g.City\norder by Region;\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "sql7124mqk",
				"poolName": "sql7124mqk"
			},
			"resultLimit": -1
		},
		"type": "SqlQuery"
	}
}